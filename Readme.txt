TVTest TVCaption3 Plugin (暫定)

■概要
TVCaptionMod2の字幕のデコードやレンダリング周りをlibaribcaption(
https://github.com/xqq/libaribcaption )に置き換えてみた字幕プラグインです。いま
のところ実験的な状態なので常用はお勧めしません(例外で落ちても知りません)。
Visual Studio 2017以降ならたぶんビルドできます。

■設定ファイルについて
以下は設定ファイル"TVCaption3.ini"のキーの説明です。
必要な場合はこれを直接編集してカスタマイズしてください。*付きのキーはプラグイン
設定のダイアログから(完全には)設定できないものです。
EnOsdCompositor
    映像への字幕合成機能を有効にする[=1]かどうか
    # レンダラはVMR9かEVRを利用し、さらに設定キーMethod[=3]としてください。
    # TVTest設定→OSD表示→「映像と合成する」とおなじ方法で字幕を表示できるよう
    # にします。たぶんつぎの場合に効果的です:
    # ・TVTest本体のキャプチャ機能でキャプをとりたい
    # ・XPや非Aero環境での性能向上
    # TVTest ver.0.9.0未満ではAPIフックを利用する比較的リスキーな機能です。Aero
    # な環境では従来の設定キーMethod[=2]を利用することをお勧めします。
EstimateViewerDelay
    表示遅延の精度を高める[=1]かどうか
    # TVTestのバッファリングなどの影響で字幕の表示がずれるのを抑制できます。
    # 遅延時間を450ミリ秒と指定したとき適切な遅れになるよう調整しています。
SettingsIndex
    現在選択中の表示設定の番号
    # このキーより下の設定は実行中に切り替え(TVTest設定→キー割り当て→表示設定
    # 切り替え)できます。
FaceName / FaceName1 / FaceName2
    使用するフォントおよびフォールバックフォント名を指定
    # 何も指定しないと適当なフォントが使われます。
Method
    字幕の表示方法
    # レイヤードウィンドウ[=2]、もしくは映像と合成[=3](要EnOsdCompositor[=1])の
    # いずれかを指定してください。
ShowFlags / ShowFlagsSuper
    字幕/文字スーパーを表示するかどうかのフラグ
    # 表示する[=65535]または表示しない[=0]のどちらかを指定してください。
DelayTime / DelayTimeSuper*
    字幕/文字スーパーを受け取ってから表示するまでの遅延時間をミリ秒で指定
    # [=-5000]から[=5000]まで。
NoBackground
    背景を常に透明にする[=1]かどうか
StrokeWidth
    字幕文の縁取りの幅の10倍
    # [=0]より大きいとき常に縁取ります。
OrnStrokeWidth
    ORN縁取り指定された字幕文の縁取りの幅の10倍
    # [=0]以上で指定します。
    # 字幕データ内で明示的に縁取りを指示されているときの幅です。
    # StrokeWidthが0より大きいときは無視されます。
ReplaceFullAlnum
    英数字を半角置換する[=1]かどうか
ReplaceDrcs
    DRCS図形を文字に置換する[=1]かどうか
    # DRCS(Dynamic Redefinable Character Set)図形を対応する文字にできるだけ置換
    # します。組み込みの置換テーブルが使われます。
IgnoreSmall
    振り仮名らしきものを除外する[=1]かどうか
RomSoundList*
    内蔵音0～18のリストを':'区切りで指定
    # フォーマット: [;]{内蔵音0}:{内蔵音1}: ... :{内蔵音18}
    # 何も指定しないか';'でコメントアウトすると内蔵音再生しません。
    # 
    # {内蔵音0}～については、プラグインフォルダにプラグインと同名(通常は
    # "TVCaption3")のフォルダをつくり、そこに配置した"{ファイル名}.wav"という音
    # 声ファイルの{ファイル名}の部分を指定してください。何も指定しないかファイル
    # がなければ再生しません。
    # "!00"～"!15"を指定すると組み込みの内蔵音("!14"と"!15"は無音)を再生します。
    # これ以外で先頭を'!'にするとシステムサウンドのエイリアスを参照します。
    # http://dobon.net/vb/dotnet/programing/playsystemsound.html などを参考に、
    # 例えば「Windowsログオン」時のサウンドは !WindowsLogon となります。
    # 
    # 参考-地デジの内蔵音定義(詳細はARIB TR-B14参照):
    # ・内蔵音0～4   速報チャイム1～5
    # ・内蔵音5～12  ボタン操作音1～8
    # ・内蔵音13     アラート音
    # ・内蔵音14～15 未定義
    # 
    # 独自定義の内蔵音(再生テストなどに便利):
    # ・内蔵音16     表示設定切り替え
    # ・内蔵音17     プラグイン有効時
    # ・内蔵音18     プラグイン無効時

■ライセンス
MITとします。

■ソース
https://github.com/xtne6f/TVCaption3

組み込みの内蔵音はソースコードの"rom"フォルダにあります。今のところ"!02"～"!04"
の音声は"!01"のものを使います。00.wavをのぞき「無料効果音」(
https://taira-komori.jpn.org/freesound.html )の素材を加工・調整したものです。
